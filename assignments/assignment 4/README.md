# Assignment 4 - Emotion analysis with pretrained language models

## Repository overview
This repository contains Python scripts for doing emotion classification of the television show *Game of Thrones* using the pretrained emotion classification model from HuggingFace. The analysis focuses on predicting emotion scores for each line in the scripts and investigating how the emotional profile changes over the course of the series.

### Assignment objective
The objective of this assignment is to:
1. Predict emotion scores for all lines in the data
2. For each season
   - Plot the distribution of all emotion labels in that season
3. For each emotion label
   - Plot the relative frequency of each emotion across all seasons

## Data source
The dataset used in this assignment is the `Game_of_Thrones_Script.csv`. It should be placed in the `in` folder before proceding with the analysis

## Steps for running the analysis

### Setting up the environment
1. **Set up the virtual environment and install requirements:**
    ```bash
    bash setup.sh
    ```
2. **Activate the virtual environment:**
    ```bash
    source EnvLang4/bin/activate
    ```

### Running the analysis
1. **Put the `Game_of_Thrones_Script.csv` in the `in`-folder. Make sure it it named that**
2. **Run the main analysis script to process the data:**
    ```bash
    python src/process_data.py
    ```
2. **Run the script to plot the results:**
    ```bash
    python src/plot_data.py
    ```
#### Extra - Top character per emotion
- **Run the script to find top characters per emotion:**
    ```bash
    python src/character_emotion_analysis.py
    ```
### Summary of the results
The `out` folder contains CSV files and plots generated by the analysis:

## Emotion distribution plots
These plots show the distribution of all emotion labels for each season. The plots are saved in the `out` folder.

Season 1 | Season 2 
:-------------------------:|:-------------------------:
![Season 1](https://github.com/BayesianBoi/cds-language/blob/main/assignments/assignment%204/out/Season%201_dist.png)  |  ![Season 2](https://github.com/BayesianBoi/cds-language/blob/main/assignments/assignment%204/out/Season%202_dist.png)

Season 3 | Season 4
:-------------------------:|:-------------------------:
![Season 3](https://github.com/BayesianBoi/cds-language/blob/main/assignments/assignment%204/out/Season%203_dist.png)  |  ![Season 4](https://github.com/BayesianBoi/cds-language/blob/main/assignments/assignment%204/out/Season%204_dist.png)


Season 5 | Season 6
:-------------------------:|:-------------------------:
![Season 5](https://github.com/BayesianBoi/cds-language/blob/main/assignments/assignment%204/out/Season%205_dist.png)  |  ![Season 6](https://github.com/BayesianBoi/cds-language/blob/main/assignments/assignment%204/out/Season%206_dist.png)

Season 7 | Season 8
:-------------------------:|:-------------------------:
![Season 7](https://github.com/BayesianBoi/cds-language/blob/main/assignments/assignment%204/out/Season%207_dist.png)  |  ![Season 8](https://github.com/BayesianBoi/cds-language/blob/main/assignments/assignment%204/out/Season%208_dist.png)

#### Emotion trends plot
This plot shows the relative frequency of each emotion across all seasons.

![Emotion Trends](https://github.com/BayesianBoi/cds-language/blob/main/assignments/assignment%204/out/emotion_trends.png)


### Extra
#### Top characters per emotion (CSV)
This file lists the top characters per emotion for each season:

| Season    | Sadness         | Joy               | Anger          | Fear             | Surprise                  | Disgust         |
|-----------|-----------------|-------------------|----------------|------------------|---------------------------|-----------------|
| Season 1  | maid            | stark bannermen   | galbart glover | jaremy rykker    | night watch stable boy    | little bird     |
| Season 2  | male singer     | myrcella          | ironborn       | group  *          | armory                    | hodor           |
| Season 3  | roslin          | unsullied         | girl           | black walder     | pyp                       | hodor           |
| Season 4  | prisoner        | women   *          | marei          | ranger           | slaves  *                  | whore           |
| Season 5  | kevan lannister | walda             | survivor       | braavosi man     | waitress                  | lollys stokeworth |
| Season 6  | othell yarwick  | crowd             | karstark       | listeners        | mistress                  | bryndel         |
| Season 7  | unsullied       | archers           | waldery frey   | drogon           | edd                       | soldier         |
| Season 8  | podrick         | all  *             | lannister soldier | melisandre    | owen                      | both   *         |

*Note the marked`*` characters are referring to a group of people

### Carbon mmissions tracking
We used CodeCarbon to track the carbon emissions caused by running this analysis. The CSV detailing the emissions can be found in the `out` folder.

### Discussion of results
As a disclaimer, I have actually not seen Game of Thrones. If you had seen the show, you could probably look at the results and go "aha, that makes sense".

- **Emotion trends over seasons**:
  - The neutral emotion is the most proninemt throughout all the seasons, which makes sense as a lot word in general are not emotionally loaded. According to the model, neutral speech account for around 40% of the dialog
  - The rest of the emotions are also relatively stable throughout the seasons. However, apparantly the inhabitants of the GoT world spend a lot more time being angry and disgusted than happy. Those two emotions make up around 12-15% of the dialog each
  - The other emotions have relatively lower scores and are also more variable

### Limitations and possible improvements
#### Limitations
- **Execution time**: The current setup takes a long time to process the data
- **Lack of benchmark**: For the current approach, we do not use any form of benchmark to validate the accuracy of the model on the GoT script. 

#### Possible Improvements
- **Advanced Models**: Implementing more advanced models such as BERT or Google's T5-Flan could probably improve the accuracy and speed of the analysis
